## Assignment 4: Matrix Decompositions for Solving Linear Systems

**Instructions:** The following problems provide you with pre-computed matrix decompositions. Your task is to use these decompositions to solve the given systems. Show all your steps for forward and backward substitution.

**Problem 1: Solving a System of Equations with LU Decomposition**
You are given the LU decomposition of a matrix $\mathbf{A} = \mathbf{LU}$, where:
$$
\mathbf{L} = \begin{pmatrix} 1 & 0 & 0 \\ 2 & 1 & 0 \\ -1 & 3 & 1 \end{pmatrix}, \quad \mathbf{U} = \begin{pmatrix} 3 & 1 & -2 \\ 0 & 2 & 4 \\ 0 & 0 & -5 \end{pmatrix}
$$
Use this decomposition to solve the linear system $\mathbf{Ax} = \mathbf{b}$ for the vector $\mathbf{x}$, where $\mathbf{b} = \begin{pmatrix} 1 \\ 6 \\ 0 \end{pmatrix}$.

Follow the two-step process:
a) First, solve for the vector $\mathbf{y}$ in the system $\mathbf{Ly} = \mathbf{b}$ using forward substitution.
b) Then, using the vector $\mathbf{y}$ you just found, solve for $\mathbf{x}$ in the system $\mathbf{Ux} = \mathbf{y}$ using backward substitution.

<br>

**Problem 2: Solving a Least Squares Problem with QR Decomposition**
The QR decomposition is a numerically stable method for finding the least squares solution to an overdetermined system $\mathbf{Ax} = \mathbf{b}$. You are given the QR decomposition of a matrix $\mathbf{A} = \mathbf{QR}$, where:
$$
\mathbf{Q} = \begin{pmatrix} 1/\sqrt{3} & -1/\sqrt{2} \\ 1/\sqrt{3} & 1/\sqrt{2} \\ 1/\sqrt{3} & 0 \end{pmatrix}, \quad \mathbf{R} = \begin{pmatrix} \sqrt{3} & \sqrt{3} \\ 0 & \sqrt{2} \end{pmatrix}
$$
Find the least squares solution $\mathbf{x}$ that minimizes $\|\mathbf{Ax} - \mathbf{b}\|^2$ for the vector $\mathbf{b} = \begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix}$.

Follow the procedure discussed in class:
a) Compute the vector $\mathbf{d} = \mathbf{Q}^T\mathbf{b}$.
b) Solve the upper triangular system $\mathbf{Rx} = \mathbf{d}$ for the least squares solution $\mathbf{x}$ using backward substitution.

<br>
<br>

## Solution Report for Assignment 4

Below are the detailed solutions for the assignment problems.

### **Solution to Problem 1: LU Decomposition**

We need to solve $\mathbf{Ax} = \mathbf{b}$ by first solving $\mathbf{Ly} = \mathbf{b}$ and then $\mathbf{Ux} = \mathbf{y}$.

**a) Forward Substitution (Solve $\mathbf{Ly} = \mathbf{b}$):**
The system is:
$$
\begin{pmatrix} 1 & 0 & 0 \\ 2 & 1 & 0 \\ -1 & 3 & 1 \end{pmatrix} \begin{pmatrix} y_1 \\ y_2 \\ y_3 \end{pmatrix} = \begin{pmatrix} 1 \\ 6 \\ 0 \end{pmatrix}
$$
This corresponds to the equations:
1) $1 \cdot y_1 + 0 \cdot y_2 + 0 \cdot y_3 = 1 \implies y_1 = 1$
2) $2 \cdot y_1 + 1 \cdot y_2 + 0 \cdot y_3 = 6$
3) $-1 \cdot y_1 + 3 \cdot y_2 + 1 \cdot y_3 = 0$

We solve from top to bottom:
From (1), we have $y_1 = 1$.
Substitute $y_1=1$ into (2): $2(1) + y_2 = 6 \implies y_2 = 4$.
Substitute $y_1=1$ and $y_2=4$ into (3): $-1(1) + 3(4) + y_3 = 0 \implies -1 + 12 + y_3 = 0 \implies y_3 = -11$.
So, the intermediate vector is $\mathbf{y} = \begin{pmatrix} 1 \\ 4 \\ -11 \end{pmatrix}$.

<br>

**b) Backward Substitution (Solve $\mathbf{Ux} = \mathbf{y}$):**
The system is:
$$
\begin{pmatrix} 3 & 1 & -2 \\ 0 & 2 & 4 \\ 0 & 0 & -5 \end{pmatrix} \begin{pmatrix} x_1 \\ x_2 \\ x_3 \end{pmatrix} = \begin{pmatrix} 1 \\ 4 \\ -11 \end{pmatrix}
$$
This corresponds to the equations:
1) $3x_1 + x_2 - 2x_3 = 1$
2) $2x_2 + 4x_3 = 4 \implies x_2 + 2x_3 = 2$
3) $-5x_3 = -11$

We solve from bottom to top:
From (3), we have $x_3 = \frac{-11}{-5} = 2.2$.
Substitute $x_3=2.2$ into (2): $x_2 + 2(2.2) = 2 \implies x_2 + 4.4 = 2 \implies x_2 = -2.4$.
Substitute $x_2=-2.4$ and $x_3=2.2$ into (1): $3x_1 + (-2.4) - 2(2.2) = 1 \implies 3x_1 - 2.4 - 4.4 = 1 \implies 3x_1 - 6.8 = 1 \implies 3x_1 = 7.8 \implies x_1 = 2.6$.

**The final solution is $\mathbf{x} = \begin{pmatrix} 2.6 \\ -2.4 \\ 2.2 \end{pmatrix}$.**

<br>

### **Solution to Problem 2: QR Decomposition**

We need to find the least squares solution by solving $\mathbf{Rx} = \mathbf{Q}^T\mathbf{b}$.

**a) Compute $\mathbf{d} = \mathbf{Q}^T\mathbf{b}$:**
First, we find the transpose of $\mathbf{Q}$:
$$
\mathbf{Q}^T = \begin{pmatrix} 1/\sqrt{3} & 1/\sqrt{3} & 1/\sqrt{3} \\ -1/\sqrt{2} & 1/\sqrt{2} & 0 \end{pmatrix}
$$
Now, we compute the product $\mathbf{Q}^T\mathbf{b}$:
$$
\mathbf{d} = \mathbf{Q}^T\mathbf{b} = \begin{pmatrix} 1/\sqrt{3} & 1/\sqrt{3} & 1/\sqrt{3} \\ -1/\sqrt{2} & 1/\sqrt{2} & 0 \end{pmatrix} \begin{pmatrix} 1 \\ 2 \\ 3 \end{pmatrix}
$$
$$
\mathbf{d} = \begin{pmatrix} (1/\sqrt{3})(1) + (1/\sqrt{3})(2) + (1/\sqrt{3})(3) \\ (-1/\sqrt{2})(1) + (1/\sqrt{2})(2) + (0)(3) \end{pmatrix} = \begin{pmatrix} 6/\sqrt{3} \\ 1/\sqrt{2} \end{pmatrix} = \begin{pmatrix} 2\sqrt{3} \\ 1/\sqrt{2} \end{pmatrix}
$$

<br>

**b) Solve $\mathbf{Rx} = \mathbf{d}$ using Backward Substitution:**
The system is:
$$
\begin{pmatrix} \sqrt{3} & \sqrt{3} \\ 0 & \sqrt{2} \end{pmatrix} \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = \begin{pmatrix} 2\sqrt{3} \\ 1/\sqrt{2} \end{pmatrix}
$$
This corresponds to the equations:
1) $\sqrt{3}x_1 + \sqrt{3}x_2 = 2\sqrt{3} \implies x_1 + x_2 = 2$
2) $\sqrt{2}x_2 = 1/\sqrt{2}$

We solve from bottom to top:
From (2), we have $x_2 = \frac{1/\sqrt{2}}{\sqrt{2}} = \frac{1}{2} = 0.5$.
Substitute $x_2 = 0.5$ into (1): $x_1 + 0.5 = 2 \implies x_1 = 1.5$.

**The least squares solution is $\mathbf{x} = \begin{pmatrix} 1.5 \\ 0.5 \end{pmatrix}$.**